<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="/layui-v2.5.6/layui/layui.js"></script>
    <link rel="stylesheet" href="/layui-v2.5.6/layui/css/layui.css">
</head>
<body>
<!--//<table class="layui-hide" id="test" lay-filter="test"></table>-->
<<div>
    <button type="button" class="layui-btn layui-btn-lg layui-bg-green " style="margin-left: 10px;">新增数据</button>
    <button type="button" class="layui-btn layui-btn-lg layui-bg-green " style="margin-left: 10px;">获取选中行数据</button>
    <button type="button" class="layui-btn layui-btn-lg layui-bg-green " style="margin-left: 10px;">获取选中数目</button>
    <button type="button" class="layui-btn layui-btn-lg layui-bg-green " style="margin-left: 10px;">验证是否全选</button>

</div>


<table id="demo" lay-filter="test"></table>
<script type="text/html" id="userBar">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="detail">查看</button>
        <button class="layui-btn layui-btn-sm" lay-event="edit">编辑</button>
        <button class="layui-btn layui-btn-danger  layui-btn-sm" lay-event="del">删除</button>
    </div>
</script>
<script type="text/html" id="switchTpl">
    <input type="checkbox" name="isRepair" lay-filter="RepairDemo" lay-skin="switch" lay-text="通过|不通过" >
</script>
<script type="text/html" id="checkboxTpl">
    <input type="checkbox" name="isRetest" lay-filter="RetestDemo" title="已复测" checked="true" >
</script>
<script type="text/html" id="feedback">
    <input type="checkbox" name="isfeedback" lay-filter="feedbackDemo" title="已反馈"  checked="true">
</script>
<script type="text/html" id="notaic">
    <input type="checkbox" name="isnotaic"   lay-filter="notaicDemo" title="已下发"  checked="true" >
</script>
<script>
    layui.use(['layer', 'form', 'table','jquery'], function (args) {
        var layer = layui.layer;
        var form = layui.form;
        var table = layui.table;
        var $ = layui.jquery;


        //加载table实例
        table.render({
            elem:"#demo",//elem用于绑定容器的id属性值
            url:"/FormServlet",//数据接口
            page: true //开启分页
            ,cols:[[//表头
                {type:'checkbox'}
                ,{field:'id',width:80, title: '序号', sort: true}
                ,{field:'bid',width:100, title: '编号', sort: true}
                ,{field:'xtname',width:100, title: '系统名称', sort: true}
                ,{field:'number',width:80, title: '个数', sort: true}
                ,{field:'level',width:80, title: '级别', sort: true}
                ,{field:'bugurl',width:100, title: '漏洞域名', sort: true}
                ,{field:'bugtype',width:100, title: '漏洞类型', sort: true}
                ,{field:'notice',width:150, title: '是否通知', sort: true,templet:'#notaic'}
                ,{field:'feedback',width:150, title: '是否反馈', sort: true,templet:'#feedback'}
                ,{field:'Retest',width:150, title: '是否复测', sort: true,templet:'#checkboxTpl'}
                ,{field:'department',width:80, title: '部'}
                ,{field:'Repair',width:100, title: '是否修复', sort: true,templet: '#switchTpl'}
                ,{field:'operation',width:100, title: '操作', sort: true, align:'center',width:200,toolbar:'#userBar'}//toolbar表示这一列是一个行内工具栏
            ]]
        })

        form.on('checkbox(notaicDemo)', function(data){
            console.log(data.elem); //原始DOM对象
            console.log(data.value); //被选中的值
            console.log(data.othis); //美化后的DOM对象
            if(data.elem.checked){
//  layer.tips('测试按钮开关的tips开关');
                layer.alert('修改为:已下发',{icon:1});

            }else{
                layer.alert('修改为:未下发',{icon:2});
            }

        });
        form.on('switch(RepairDemo)',function(data){
            var x=this.checked ? true : false
            if(x){
                data.value="通过"
                console.log(data.value)
            }else{
                data.value="不通过"
                console.log(data.value)
            }
            /*$.ajax({
                url:'/FormServlet',
                type:'post',
                data:{
                    'Repair':data.othis.text()
                },
                dataType:'json',
                success:function (res) {
                    // console.log(res)
                }
            })*/
            //监听指定开关
            layer.msg('开关checked：'+ (this.checked ? 'true' : 'false'), {
                offset: '6px'
            });
            //layer.tips('温馨提示：请注意开关状态的文字可以随意定义，而不仅仅是ON|OFF', data.othis)
        });

        //监听工具条
        table.on('tool(test)', function(obj){
            var data = obj.data;
            if(obj.event === 'detail'){
                layer.msg('ID：'+ data.id + ' 的查看操作');
            } else if(obj.event === 'del'){
                layer.confirm('真的删除行么', function(index){
                    obj.del();
                    layer.close(index);
                });
            } else if(obj.event === 'edit'){
                layer.alert('编辑行：<br>'+ JSON.stringify(data))
            }
        });
    });
</script>
</body>

</html>